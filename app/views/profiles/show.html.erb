<h1><%= @freelancer.display_name %></h1>
<p><%= @freelancer.bio %></p>
<p>⭐ <%= @freelancer.average_rating || "No ratings yet" %> · <%= @freelancer.review_count %> reviews</p>

<hr>

<h2>Reviews</h2>

<% @reviews.each do |review| %>
  <div>
    <p><strong><%= review.reviewer.display_name %></strong> · <%= review.stars %> stars</p>
    <p><%= review.body %></p>
    <p><small><%= review.created_at.strftime("%B %d, %Y") %></small></p>
  </div>
<% end %>

<hr>

<% if user_signed_in? %>
  <h2>Leave a Review</h2>
  <%= form_tag("/insert_review") do %>
    <input type="hidden" name="query_reviewee_id" value="<%= @freelancer.id %>">
    <div data-controller="star-rating">
      <label>Stars</label>
      <input type="hidden" name="query_stars"  data-star-rating-target="input" value="0">
      <div>
        <% (1..5).each do |i| %>
          <span
          data-star-rating-target="star"
          data-value="<%= i %>"
          data-action="click->star-rating#select mouseover->star-rating#highlight mouseout->star-rating#reset"
            style="cursor:pointer; font-size: 2rem;">
            ☆
          </span>
        <% end %>
      </div>
    </div>
    <div>
      <label>Your Review</label>
      <textarea name="query_body" required></textarea>
    </div>
    <button type="submit">Submit Review</button>
  <% end %>
<% else %>
  <p><%= link_to "Sign in to leave a review", new_user_session_path %></p>
<% end %>
